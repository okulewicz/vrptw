\hypertarget{_assignment_optimizer_8cs_source}{}\doxysection{Assignment\+Optimizer.\+cs}
\label{_assignment_optimizer_8cs_source}\index{AssignmentOptimizer.cs@{AssignmentOptimizer.cs}}
\mbox{\hyperlink{_assignment_optimizer_8cs}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00001}00001 \textcolor{keyword}{using} \mbox{\hyperlink{namespace_common_g_i_s}{CommonGIS}}.\mbox{\hyperlink{namespace_common_g_i_s_1_1_enums}{Enums}};}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00002}00002 \textcolor{keyword}{using} \mbox{\hyperlink{namespace_common_g_i_s}{CommonGIS}}.\mbox{\hyperlink{namespace_common_g_i_s_1_1_interfaces}{Interfaces}};}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00003}00003 \textcolor{keyword}{using} System;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00004}00004 \textcolor{keyword}{using} System.Collections.Generic;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00005}00005 \textcolor{keyword}{using} System.Diagnostics;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00006}00006 \textcolor{keyword}{using} System.Linq;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00007}00007 \textcolor{keyword}{using} System.Text;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00008}00008 \textcolor{keyword}{using} System.Threading.Tasks;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00009}00009 \textcolor{keyword}{using} \mbox{\hyperlink{namespace_v_r_p_t_w_optimizer}{VRPTWOptimizer}}.\mbox{\hyperlink{namespace_v_r_p_t_w_optimizer_1_1_interfaces}{Interfaces}};}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00010}00010 \textcolor{keyword}{using} \mbox{\hyperlink{namespace_v_r_p_t_w_optimizer}{VRPTWOptimizer}}.\mbox{\hyperlink{namespace_v_r_p_t_w_optimizer_1_1_utils}{Utils}}.\mbox{\hyperlink{namespace_v_r_p_t_w_optimizer_1_1_utils_1_1_validation}{Validation}};}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00011}00011 }
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00012}\mbox{\hyperlink{namespace_v_r_p_t_w_optimizer_1_1_b_l_1_1_meta}{00012}} \textcolor{keyword}{namespace }\mbox{\hyperlink{namespace_v_r_p_t_w_optimizer_1_1_b_l_1_1_meta_1_1_assignment}{VRPTWOptimizer.BL.Meta.Assignment}}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00013}00013 \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00017}\mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_b_l_1_1_meta_1_1_assignment_1_1_assignment_optimizer}{00017}}     \textcolor{keyword}{public} \textcolor{keyword}{class }\mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_b_l_1_1_meta_1_1_assignment_1_1_assignment_optimizer}{AssignmentOptimizer}} : \mbox{\hyperlink{interface_v_r_p_t_w_optimizer_1_1_interfaces_1_1_i_v_r_p_optimizer}{IVRPOptimizer}}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00018}00018     \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00019}00019         \textcolor{keyword}{private} readonly \textcolor{keywordtype}{double} maxComputatationSeconds;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00020}00020         \textcolor{keyword}{private} readonly \textcolor{keywordtype}{int} maxIterations;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00021}00021         \textcolor{keyword}{private} readonly \textcolor{keywordtype}{int} maxProcessorsCount;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00022}00022         \textcolor{keyword}{private} Random randomNumberGenarator;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00023}00023 }
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00024}00024         \textcolor{keyword}{internal} \mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_b_l_1_1_meta_1_1_assignment_1_1_assignment_optimizer}{AssignmentOptimizer}}(\textcolor{keywordtype}{int} maxIterations, \textcolor{keywordtype}{double} maxComputatationSeconds, \textcolor{keywordtype}{int} maxProcessorsCount)}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00025}00025         \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00026}00026             \textcolor{comment}{//TODO 1 enable tractor assignment}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00027}00027             \textcolor{comment}{//TODO 3 enable solution cross-\/over}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00028}00028             this.randomNumberGenarator = \textcolor{keyword}{new} Random(1);}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00029}00029             this.maxProcessorsCount = maxProcessorsCount;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00030}00030             this.maxIterations = maxIterations;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00031}00031             this.maxComputatationSeconds = maxComputatationSeconds;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00032}00032         \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00033}00033 }
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00034}00034         \textcolor{keyword}{private} \textcolor{keyword}{static} Dictionary<TransportRequest, List<TransportRequest>> ClusterRequestsIntoFutureRoutes(\mbox{\hyperlink{interface_v_r_p_t_w_optimizer_1_1_interfaces_1_1_i_time_estimator}{ITimeEstimator}} timeEstimator, \mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_v_r_p_cost_function}{VRPCostFunction}} costFunction, \mbox{\hyperlink{interface_common_g_i_s_1_1_interfaces_1_1_i_distance_provider}{IDistanceProvider}} distanceProvider, IGrouping<\mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_vehicle}{Vehicle}}, KeyValuePair<TransportRequest, Vehicle>> vehiclesGroup, \textcolor{keywordtype}{string} homeDepotId)}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00035}00035         \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00036}00036             var requests = vehiclesGroup.Select(kvp => kvp.Key).ToList();}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00037}00037             var vehicle = vehiclesGroup.Key;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00038}00038             var edges = \mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_b_l_1_1_meta_1_1_edge}{Edge}}.\mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_b_l_1_1_meta_1_1_edge_ae589d0ce8d4e4d5cbc73212f5bb74ab0}{CreateEdgesBetweenVariousNodes}}(requests, \textcolor{keyword}{new} List<Vehicle>() \{ vehicle \}, homeDepotId, distanceProvider, timeEstimator, vehicle.RoadProperties, \textcolor{keywordtype}{double}.MaxValue, costFunction);}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00039}00039             Dictionary<TransportRequest, List<TransportRequest>> clusters = \textcolor{keyword}{new} Dictionary<TransportRequest, List<TransportRequest>>();}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00040}00040             \textcolor{keywordflow}{foreach} (var request \textcolor{keywordflow}{in} requests)}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00041}00041             \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00042}00042                 clusters.Add(request, \textcolor{keyword}{new} List<TransportRequest>() \{ request \});}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00043}00043             \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00044}00044             \textcolor{keywordflow}{foreach} (var edge \textcolor{keywordflow}{in} edges)}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00045}00045             \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00046}00046                 \textcolor{keywordflow}{if} (clusters[edge.FirstRequest] == clusters[edge.SecondRequest])}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00047}00047                 \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00048}00048                     \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00049}00049                 \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00050}00050                 \textcolor{keywordflow}{if} (!vehicle.CanFitRequestsSomewhereInVehicle(clusters[edge.FirstRequest].Concat(clusters[edge.SecondRequest])))}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00051}00051                 \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00052}00052                     \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00053}00053                 \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00054}00054                 clusters[edge.FirstRequest].AddRange(clusters[edge.SecondRequest]);}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00055}00055                 \textcolor{keywordflow}{foreach} (var requestKey \textcolor{keywordflow}{in} clusters[edge.SecondRequest])}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00056}00056                 \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00057}00057                     clusters[requestKey] = clusters[edge.FirstRequest];}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00058}00058                 \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00059}00059             \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00060}00060 }
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00061}00061             \textcolor{keywordflow}{return} clusters;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00062}00062         \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00063}00063 }
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00064}00064         \textcolor{keyword}{private} \textcolor{keyword}{static} Dictionary<TransportRequest, List<Vehicle>> CreateCapacitatedVehicleFilter(\mbox{\hyperlink{interface_v_r_p_t_w_optimizer_1_1_interfaces_1_1_i_v_r_p_provider}{IVRPProvider}} problemDataProvider, List<Vehicle> capacitatedVehicles)}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00065}00065         \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00066}00066             Dictionary<TransportRequest, List<Vehicle>> availableCapacitatedVehicles = \textcolor{keyword}{new}();}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00067}00067             \textcolor{keywordflow}{foreach} (var request \textcolor{keywordflow}{in} problemDataProvider.\mbox{\hyperlink{interface_v_r_p_t_w_optimizer_1_1_interfaces_1_1_i_v_r_p_provider_af8d49aa28e8758bf0aa710d8e295fdb2}{Requests}})}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00068}00068             \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00069}00069                 availableCapacitatedVehicles.Add(request, \textcolor{keyword}{new}());}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00070}00070                 availableCapacitatedVehicles[request].AddRange(capacitatedVehicles.Where(v => v.CanHandleRequest(request)));}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00071}00071             \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00072}00072 }
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00073}00073             \textcolor{keywordflow}{return} availableCapacitatedVehicles;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00074}00074         \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00075}00075 }
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00076}00076         \textcolor{keyword}{private} \textcolor{keyword}{static} Dictionary<Vehicle, List<Vehicle>> CreateEngineVehiclesFilter(List<Vehicle> capacitatedVehicles, List<Vehicle> engineVehicles)}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00077}00077         \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00078}00078             Dictionary<Vehicle, List<Vehicle>> availableEngineVehicles = \textcolor{keyword}{new}();}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00079}00079             \textcolor{keywordflow}{foreach} (var capacitedVehicle \textcolor{keywordflow}{in} capacitatedVehicles)}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00080}00080             \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00081}00081                 availableEngineVehicles.Add(capacitedVehicle, \textcolor{keyword}{new}());}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00082}00082                 \textcolor{keywordflow}{if} (capacitedVehicle.Type == \mbox{\hyperlink{namespace_common_g_i_s_1_1_enums_a9254700078ab0f52e4f96e3257f9625c}{VehicleType}}.StraightTruck)}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00083}00083                 \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00084}00084                     availableEngineVehicles[capacitedVehicle].Add(capacitedVehicle);}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00085}00085                 \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00086}00086                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (capacitedVehicle.Type == \mbox{\hyperlink{namespace_common_g_i_s_1_1_enums_a9254700078ab0f52e4f96e3257f9625c}{VehicleType}}.SemiTrailer)}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00087}00087                 \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00088}00088                     availableEngineVehicles[capacitedVehicle].AddRange(engineVehicles.Where(eng => eng.Type == \mbox{\hyperlink{namespace_common_g_i_s_1_1_enums_a9254700078ab0f52e4f96e3257f9625c}{VehicleType}}.Tractor));}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00089}00089                 \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00090}00090             \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00091}00091 }
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00092}00092             \textcolor{keywordflow}{return} availableEngineVehicles;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00093}00093         \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00094}00094 }
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00095}00095         \textcolor{keyword}{private} \textcolor{keyword}{static} \textcolor{keywordtype}{void} FillInDistanceDictionaryCache(\mbox{\hyperlink{interface_v_r_p_t_w_optimizer_1_1_interfaces_1_1_i_v_r_p_provider}{IVRPProvider}} problemDataProvider, \mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_v_r_p_cost_function}{VRPCostFunction}} costFunctionFactors, \mbox{\hyperlink{interface_v_r_p_t_w_optimizer_1_1_interfaces_1_1_i_time_estimator}{ITimeEstimator}} serviceTimeEstimator, \mbox{\hyperlink{interface_common_g_i_s_1_1_interfaces_1_1_i_distance_provider}{IDistanceProvider}} distanceProvider)}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00096}00096         \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00097}00097             \textcolor{keyword}{new} Cluster.GeneralizedClustering.ClusterizingVRPOptimizer(\textcolor{keyword}{false}, -\/1, 0, 0, \textcolor{keyword}{true}).Optimize(problemDataProvider, costFunctionFactors, serviceTimeEstimator, distanceProvider);}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00098}00098         \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00099}00099 }
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00100}00100         \textcolor{keyword}{private} \mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_v_r_p_optimizer_result}{VRPOptimizerResult}} CreateRoutesFromAssignment(Dictionary<TransportRequest, Vehicle> assignment, Dictionary<\mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_vehicle}{Vehicle}}, List<Vehicle>> availableEngineVehicles, \mbox{\hyperlink{interface_v_r_p_t_w_optimizer_1_1_interfaces_1_1_i_time_estimator}{ITimeEstimator}} timeEstimator, \mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_v_r_p_cost_function}{VRPCostFunction}} costFunction, \mbox{\hyperlink{interface_common_g_i_s_1_1_interfaces_1_1_i_distance_provider}{IDistanceProvider}} distanceProvider, \textcolor{keywordtype}{string} homeDepotId)}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00101}00101         \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00102}00102             \mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_v_r_p_optimizer_result}{VRPOptimizerResult}} returnedResult = \textcolor{keyword}{new}()}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00103}00103             \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00104}00104                 LeftRequests = \textcolor{keyword}{new}(),}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00105}00105                 Routes = \textcolor{keyword}{new}()}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00106}00106             \};}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00107}00107             var routes = \textcolor{keyword}{new} List<Route>();}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00108}00108             returnedResult.\mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_v_r_p_optimizer_result_a23bc25eb77719323fda0fbb2ecd77517}{LeftRequests}}.AddRange(assignment.Keys);}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00109}00109             var vehiclesSchedule = \textcolor{keyword}{new} Dictionary<Vehicle, VehicleSchedule>();}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00110}00110             var subsequentRoutes = \textcolor{keyword}{new} Dictionary<Route, ISet<Route>>();}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00111}00111             \textcolor{keywordflow}{foreach} (var vehiclesGroup \textcolor{keywordflow}{in} assignment.GroupBy(pair => pair.Value))}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00112}00112             \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00113}00113                 var vehicle = vehiclesGroup.Key;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00114}00114                 var vehicleSchedule = \textcolor{keyword}{new} \mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_b_l_1_1_meta_1_1_vehicle_schedule}{VehicleSchedule}}(vehicle, \textcolor{keywordtype}{double}.MaxValue, 0.0);}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00115}00115                 \textcolor{keywordflow}{if} (!vehiclesSchedule.ContainsKey(vehicle))}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00116}00116                 \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00117}00117                     vehiclesSchedule.Add(vehicle, vehicleSchedule);}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00118}00118                 \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00119}00119                 Dictionary<TransportRequest, List<TransportRequest>> clusters = ClusterRequestsIntoFutureRoutes(timeEstimator, costFunction, distanceProvider, vehiclesGroup, homeDepotId);}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00120}00120                 List<List<TransportRequest>> distinctClusters = clusters.Values.Distinct().ToList();}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00121}00121                 \textcolor{keywordflow}{foreach} (var cluster \textcolor{keywordflow}{in} distinctClusters)}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00122}00122                 \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00123}00123                     \mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_b_l_1_1_meta_1_1_route}{Route}} route = \textcolor{keyword}{new} \mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_b_l_1_1_meta_1_1_route}{Route}}(vehicle, \textcolor{keyword}{null}, \textcolor{keyword}{null}, distanceProvider, timeEstimator);}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00124}00124                     \textcolor{keywordflow}{foreach} (var request \textcolor{keywordflow}{in} cluster)}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00125}00125                     \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00126}00126                         var result = route.FindBestInsertionForRequest(request);}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00127}00127                         \textcolor{keywordflow}{if} (result.Success)}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00128}00128                         \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00129}00129                             route.Insert(result.InsertionIndex, request);}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00130}00130                             returnedResult.LeftRequests.Remove(request);}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00131}00131                         \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00132}00132                     \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00133}00133                     \textcolor{keywordflow}{if} (vehicleSchedule.RouteFitsIntoSchedule(route, vehiclesSchedule, subsequentRoutes))}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00134}00134                     \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00135}00135                         route.SchedulesAddTo(vehiclesSchedule, routes, subsequentRoutes);}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00136}00136                     \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00137}00137                     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00138}00138                     \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00139}00139                         returnedResult.LeftRequests.AddRange(cluster);}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00140}00140                     \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00141}00141                 \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00142}00142             \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00143}00143             returnedResult.Routes.AddRange(routes);}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00144}00144             \textcolor{keywordflow}{return} returnedResult;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00145}00145         \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00146}00146 }
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00147}00147         \textcolor{keyword}{private} Dictionary<TransportRequest, Vehicle> GenerateClusteredVehicleAssignment(\mbox{\hyperlink{interface_v_r_p_t_w_optimizer_1_1_interfaces_1_1_i_v_r_p_provider}{IVRPProvider}} problemDataProvider, \mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_v_r_p_cost_function}{VRPCostFunction}} costFunctionFactors, \mbox{\hyperlink{interface_v_r_p_t_w_optimizer_1_1_interfaces_1_1_i_time_estimator}{ITimeEstimator}} serviceTimeEstimator, \mbox{\hyperlink{interface_common_g_i_s_1_1_interfaces_1_1_i_distance_provider}{IDistanceProvider}} distanceProvider, Dictionary<\mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_transport_request}{TransportRequest}}, List<Vehicle>> availableCapacitatedVehicles, Dictionary<\mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_vehicle}{Vehicle}}, List<Vehicle>> availableEngineVehicles)}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00148}00148         \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00149}00149             var assignment = \textcolor{keyword}{new} Dictionary<TransportRequest, Vehicle>();}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00150}00150             \textcolor{keywordtype}{int} randomSeed = randomNumberGenarator.Next();}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00151}00151             \textcolor{keywordtype}{double} maxDelayWithinRoute = randomNumberGenarator.Next(4) * 3600;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00152}00152             var optimizer = \textcolor{keyword}{new} Cluster.GeneralizedClustering.ClusterizingVRPOptimizer(\textcolor{keyword}{true}, randomSeed, maxDelayWithinRoute, 0, \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00153}00153             var result = optimizer.Optimize(problemDataProvider, costFunctionFactors, serviceTimeEstimator, distanceProvider);}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00154}00154             \textcolor{keywordflow}{foreach} (var route \textcolor{keywordflow}{in} result.Routes)}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00155}00155             \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00156}00156                 \textcolor{keywordflow}{foreach} (var loadedRequests \textcolor{keywordflow}{in} route.LoadedRequests)}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00157}00157                 \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00158}00158                     \textcolor{keywordflow}{foreach} (var loaded \textcolor{keywordflow}{in} loadedRequests)}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00159}00159                     \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00160}00160                         assignment.Add(loaded, route.Vehicle);}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00161}00161                     \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00162}00162                 \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00163}00163             \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00164}00164             \textcolor{keywordflow}{foreach} (var unassignedRequest \textcolor{keywordflow}{in} result.LeftRequests)}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00165}00165             \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00166}00166                 assignment.Add(unassignedRequest, availableCapacitatedVehicles[unassignedRequest][randomNumberGenarator.Next(availableCapacitatedVehicles[unassignedRequest].Count)]);}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00167}00167             \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00168}00168             \textcolor{keywordflow}{return} assignment;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00169}00169         \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00170}00170 }
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00171}00171         \textcolor{keyword}{private} Dictionary<TransportRequest, Vehicle> GenerateRandomVehicleAssignment(List<TransportRequest> requests, Dictionary<\mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_transport_request}{TransportRequest}}, List<Vehicle>> availableCapacitatedVehicles, Dictionary<\mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_vehicle}{Vehicle}}, List<Vehicle>> availableEngineVehicles)}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00172}00172         \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00173}00173             Dictionary<TransportRequest, Vehicle> assignment = \textcolor{keyword}{new}();}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00174}00174             \textcolor{keywordflow}{foreach} (var request \textcolor{keywordflow}{in} requests)}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00175}00175             \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00176}00176                 assignment.Add(request, availableCapacitatedVehicles[request][randomNumberGenarator.Next(availableCapacitatedVehicles[request].Count)]);}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00177}00177             \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00178}00178             \textcolor{keywordflow}{return} assignment;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00179}00179         \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00180}00180 }
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00181}\mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_b_l_1_1_meta_1_1_assignment_1_1_assignment_optimizer_a220f1889a88cda1c5c5f63b90a40881c}{00181}}         \textcolor{keyword}{public} \mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_v_r_p_optimizer_result}{VRPOptimizerResult}} \mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_b_l_1_1_meta_1_1_assignment_1_1_assignment_optimizer_a220f1889a88cda1c5c5f63b90a40881c}{Optimize}}(\mbox{\hyperlink{interface_v_r_p_t_w_optimizer_1_1_interfaces_1_1_i_v_r_p_provider}{IVRPProvider}} problemDataProvider, \mbox{\hyperlink{interface_v_r_p_t_w_optimizer_1_1_interfaces_1_1_i_time_estimator}{ITimeEstimator}} serviceTimeEstimator, \mbox{\hyperlink{interface_common_g_i_s_1_1_interfaces_1_1_i_distance_provider}{IDistanceProvider}} distanceProvider)}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00182}00182         \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00183}00183             \textcolor{keywordflow}{return} \mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_b_l_1_1_meta_1_1_assignment_1_1_assignment_optimizer_a220f1889a88cda1c5c5f63b90a40881c}{Optimize}}(}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00184}00184                 problemDataProvider,}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00185}00185                 \mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_v_r_p_cost_function}{VRPCostFunction}}.\mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_v_r_p_cost_function_a79565414d578890a651795ea4404ed5c}{GetDefaultParametersFunction}}(),}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00186}00186                 serviceTimeEstimator,}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00187}00187                 distanceProvider}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00188}00188                 );}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00189}00189         \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00190}00190 }
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00191}\mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_b_l_1_1_meta_1_1_assignment_1_1_assignment_optimizer_a27c26cee0988970fe420f31c86fc69fc}{00191}}         \textcolor{keyword}{public} \mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_v_r_p_optimizer_result}{VRPOptimizerResult}} \mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_b_l_1_1_meta_1_1_assignment_1_1_assignment_optimizer_a27c26cee0988970fe420f31c86fc69fc}{Optimize}}(\mbox{\hyperlink{interface_v_r_p_t_w_optimizer_1_1_interfaces_1_1_i_v_r_p_provider}{IVRPProvider}} problemDataProvider, \mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_v_r_p_cost_function}{VRPCostFunction}} costFunctionFactors, \mbox{\hyperlink{interface_v_r_p_t_w_optimizer_1_1_interfaces_1_1_i_time_estimator}{ITimeEstimator}} serviceTimeEstimator, \mbox{\hyperlink{interface_common_g_i_s_1_1_interfaces_1_1_i_distance_provider}{IDistanceProvider}} distanceProvider)}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00192}00192         \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00193}00193             \textcolor{keywordflow}{if} (problemDataProvider.\mbox{\hyperlink{interface_v_r_p_t_w_optimizer_1_1_interfaces_1_1_i_v_r_p_provider_a39bfa8581acd1ac981b63f681d184b00}{Drivers}} != \textcolor{keyword}{null} \&\& problemDataProvider.\mbox{\hyperlink{interface_v_r_p_t_w_optimizer_1_1_interfaces_1_1_i_v_r_p_provider_a39bfa8581acd1ac981b63f681d184b00}{Drivers}}.Count > 0)}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00194}00194             \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00195}00195                 \textcolor{keywordflow}{throw} \textcolor{keyword}{new} NotImplementedException(\textcolor{stringliteral}{"{}This algorithm is not prepared for handling drivers"{}});}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00196}00196             \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00197}00197             \textcolor{keywordflow}{if} (problemDataProvider.\mbox{\hyperlink{interface_v_r_p_t_w_optimizer_1_1_interfaces_1_1_i_v_r_p_provider_a4199547318344b5c4f5cf5cfc2765fa1}{Vehicles}}.Any(vh => vh.Type == \mbox{\hyperlink{namespace_common_g_i_s_1_1_enums_a9254700078ab0f52e4f96e3257f9625c}{VehicleType}}.Tractor || vh.Type == \mbox{\hyperlink{namespace_common_g_i_s_1_1_enums_a9254700078ab0f52e4f96e3257f9625c}{VehicleType}}.SemiTrailer))}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00198}00198             \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00199}00199                 \textcolor{keywordflow}{throw} \textcolor{keyword}{new} NotImplementedException(\textcolor{stringliteral}{"{}This algorithm is not prepared for handling tractors and trailers"{}});}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00200}00200             \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00201}00201             List<Vehicle> capacitatedVehicles = \textcolor{keyword}{new} List<Vehicle>();}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00202}00202             List<Vehicle> engineVehicles = \textcolor{keyword}{new} List<Vehicle>();}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00203}00203             List<Driver> drivers = \textcolor{keyword}{new} List<Driver>();}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00204}00204             capacitatedVehicles.AddRange(problemDataProvider.\mbox{\hyperlink{interface_v_r_p_t_w_optimizer_1_1_interfaces_1_1_i_v_r_p_provider_a4199547318344b5c4f5cf5cfc2765fa1}{Vehicles}}.Where(vh => vh.Type == \mbox{\hyperlink{namespace_common_g_i_s_1_1_enums_a9254700078ab0f52e4f96e3257f9625c}{VehicleType}}.SemiTrailer || vh.Type == \mbox{\hyperlink{namespace_common_g_i_s_1_1_enums_a9254700078ab0f52e4f96e3257f9625c}{VehicleType}}.StraightTruck));}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00205}00205             engineVehicles.AddRange(problemDataProvider.\mbox{\hyperlink{interface_v_r_p_t_w_optimizer_1_1_interfaces_1_1_i_v_r_p_provider_a4199547318344b5c4f5cf5cfc2765fa1}{Vehicles}}.Where(vh => vh.Type == \mbox{\hyperlink{namespace_common_g_i_s_1_1_enums_a9254700078ab0f52e4f96e3257f9625c}{VehicleType}}.Tractor || vh.Type == \mbox{\hyperlink{namespace_common_g_i_s_1_1_enums_a9254700078ab0f52e4f96e3257f9625c}{VehicleType}}.StraightTruck));}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00206}00206             Dictionary<TransportRequest, List<Vehicle>> availableCapacitatedVehicles = CreateCapacitatedVehicleFilter(problemDataProvider, capacitatedVehicles);}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00207}00207             Dictionary<Vehicle, List<Vehicle>> availableEngineVehicles = CreateEngineVehiclesFilter(capacitatedVehicles, engineVehicles);}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00208}00208             \mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_v_r_p_optimizer_result}{VRPOptimizerResult}} bestResult = \textcolor{keyword}{new} \mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_v_r_p_optimizer_result}{VRPOptimizerResult}}() \{ Routes = \textcolor{keyword}{new}(), LeftRequests = \textcolor{keyword}{new}() \};}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00209}00209             bestResult.\mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_v_r_p_optimizer_result_a23bc25eb77719323fda0fbb2ecd77517}{LeftRequests}}.AddRange(problemDataProvider.\mbox{\hyperlink{interface_v_r_p_t_w_optimizer_1_1_interfaces_1_1_i_v_r_p_provider_af8d49aa28e8758bf0aa710d8e295fdb2}{Requests}});}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00210}00210             \textcolor{keywordtype}{double} bestResultValue = costFunctionFactors.\mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_v_r_p_cost_function_ad5232bfc7d6ef1d0ad9c3251f9a0fb41}{Value}}(bestResult.\mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_v_r_p_optimizer_result_a3a359f38a3ad72feca31b2dd6ec298de}{Routes}}, bestResult.\mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_v_r_p_optimizer_result_a23bc25eb77719323fda0fbb2ecd77517}{LeftRequests}});}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00211}00211             \textcolor{keywordtype}{int}[] proc = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[Math.Min(Environment.ProcessorCount, maxProcessorsCount)];}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00212}00212             FillInDistanceDictionaryCache(problemDataProvider, costFunctionFactors, serviceTimeEstimator, distanceProvider);}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00213}00213             \mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_v_r_p_optimizer_result}{VRPOptimizerResult}}[] localBestResult = \textcolor{keyword}{new} \mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_v_r_p_optimizer_result}{VRPOptimizerResult}}[proc.Length];}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00214}00214             \textcolor{keywordtype}{double}[] localBestResultValue = \textcolor{keyword}{new} \textcolor{keywordtype}{double}[proc.Length];}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00215}00215             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < proc.Length; i++)}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00216}00216             \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00217}00217                 proc[i] = i;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00218}00218             \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00219}00219             var iters = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[proc.Length];}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00220}00220             proc.AsParallel().ForAll(p =>}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00221}00221             \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00222}00222                 var computStart = DateTime.UtcNow;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00223}00223                 localBestResult[p] = bestResult;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00224}00224                 localBestResultValue[p] = bestResultValue;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00225}00225                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < maxIterations / proc.Length \&\& (DateTime.UtcNow -\/ computStart).TotalSeconds < maxComputatationSeconds; i++)}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00226}00226                 \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00227}00227                     Dictionary<TransportRequest, Vehicle> assignment = GenerateClusteredVehicleAssignment(problemDataProvider, costFunctionFactors, serviceTimeEstimator, distanceProvider, availableCapacitatedVehicles, availableEngineVehicles);}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00228}00228                     \textcolor{comment}{//Dictionary<TransportRequest, Vehicle> assignment = GenerateRandomVehicleAssignment(problemDataProvider.Requests, availableCapacitatedVehicles, availableEngineVehicles);}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00229}00229                     var candidateResult = CreateRoutesFromAssignment(assignment, availableEngineVehicles, serviceTimeEstimator, costFunctionFactors, distanceProvider, problemDataProvider.\mbox{\hyperlink{interface_v_r_p_t_w_optimizer_1_1_interfaces_1_1_i_v_r_p_provider_a2d19009b7dd660f4e205890a57f81aed}{HomeDepot}}.Id);}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00230}00230                     var candidateResultValue = costFunctionFactors.\mbox{\hyperlink{class_v_r_p_t_w_optimizer_1_1_v_r_p_cost_function_ad5232bfc7d6ef1d0ad9c3251f9a0fb41}{Value}}(candidateResult.Routes, candidateResult.LeftRequests);}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00231}00231                     \textcolor{keywordflow}{if} (candidateResultValue < localBestResultValue[p])}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00232}00232                     \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00233}00233                         localBestResult[p] = candidateResult;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00234}00234                         localBestResultValue[p] = candidateResultValue;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00235}00235                     \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00236}00236                     iters[p] = i + 1;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00237}00237                 \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00238}00238             \});}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00239}00239             Console.WriteLine(\$\textcolor{stringliteral}{"{}Total iterations: \{iters.Sum()\}"{}});}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00240}00240             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < proc.Length; i++)}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00241}00241             \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00242}00242                 \textcolor{keywordflow}{if} (localBestResultValue[i] < bestResultValue)}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00243}00243                 \{}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00244}00244                     bestResult = localBestResult[i];}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00245}00245                     bestResultValue = localBestResultValue[i];}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00246}00246                 \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00247}00247             \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00248}00248             \textcolor{keywordflow}{return} bestResult;}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00249}00249         \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00250}00250     \}}
\DoxyCodeLine{\Hypertarget{_assignment_optimizer_8cs_source_l00251}00251 \}}

\end{DoxyCode}
